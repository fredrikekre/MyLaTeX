% ContMech.sty
% Package for continuum mechanics
% Based on https://github.com/Micket/chalmers/blob/master/contmech.sty
% Modified by Fredrik Ekre, fredrik.ekre@chalmers.se

\ProvidesPackage{ContMech}

\RequirePackage{mathtools}
\RequirePackage{amssymb}

% The common binary operators
\newcommand{\dprodt}{\mathbin{\cdot\cdot}} % Double product transpose
\newcommand{\dprod}{\mathbin{\vcentcolon}} % Double product
\newcommand{\cross}{\mathbin{\times}} % Cross product
\newcommand{\outerp}{\mathbin{\otimes}} % Outer product
\newcommand{\oprod}{\outerp} % Open product
\newcommand{\uouterp}{\mathbin{\overline{\otimes}}} % Upper outer product
\newcommand{\louterp}{\mathbin{\underline{\otimes}}} % Lower outer product

% Tensors
\newcommand{\ta}[1]{\boldsymbol{#1}} % First order tensor. Bold, cursive
%\newcommand{\ts}[1]{\boldsymbol{\mathrm{#1}}} % Second order tensor. Bold, straigt
\newcommand{\ts}[1]{\boldsymbol{#1}} % Second order tensor. Bold, cursive
\newcommand{\td}[1]{\boldsymbol{\mathcal{#1}}} % Third order tensor. Bold, caligraphy
\newcommand{\tf}[1]{\boldsymbol{\mathsf{#1}}} % Fourth order tensor. Bold, sans-serif

% Alternative commands when using unicode-math.
%\renewcommand{\ta}[1]{\mathbfit{#1}}
%\renewcommand{\ts}[1]{\mathbfit{#1}}
%\renewcommand{\td}[1]{\mathbfcal{#1}}
%\renewcommand{\tf}[1]{\mathbfsf{#1}}

\newcommand{\vect}[1]{\underline{#1}} % Vectors
\renewcommand{\vec}[1]{\underline{#1}} % Vectors
\newcommand{\mat}[1]{\underline{#1}} % Matrices (even if they are the same, keep them seperate if you ever wish to change it.

\newcommand{\set}[1]{\mathbb{#1}} % For defining sets

\newcommand{\diff}{\ts\nabla} % Very common operator
\newcommand{\grad}{\diff}

\newcommand{\majorT}{\mathrm{T}} % For major transpose, \ts A^\majorT
\newcommand{\minorT}{\mathrm{t}} % For minor transpose, \tf A^\minorT

% Common decorations for tensors.
\newcommand{\dev}{\mathrm{dev}} % Deviatoric part
\newcommand{\vol}{\mathrm{vol}} % Volumetric part
\newcommand{\sym}{\mathrm{s}} % Symmetric part
\newcommand{\skw}{\mathrm{skw}} % Skew part
\newcommand{\sph}{\mathrm{sph}} % Spherical part
\newcommand{\trial}{\mathrm{tr}} % Trial value
\newcommand{\el}{\mathrm{e}} % Elastic
\newcommand{\pl}{\mathrm{p}} % Plastic
\newcommand{\eff}{\mathrm{e}} % Effective value
\newcommand{\eqv}{\mathrm{e}} % Equivalent value
\newcommand{\alg}{\mathrm{a}} % Algorithmic value
\newcommand{\mean}{\mathrm{m}} % Mean value
\newcommand{\red}{\mathrm{red}} % Reduced value
\newcommand{\thres}{\mathrm{th}} % Threshold value
\newcommand{\macro}{\mathrm{M}} % Macroscopic value
% \newcommand{\fluct}{\mathrm{s}} % Fluctuation
\newcommand{\fluct}{\mathrm{\mu}} % Fluctuation
\newcommand{\micro}{\fluct} % Microscopic value (fluctuation)
\newcommand{\nominal}{\mathrm{nom}} % Nominal value

\newcommand{\Dissipation}{\mathcal{D}}
\newcommand{\Dirichlet}{\mathrm{D}}
\newcommand{\Neumann}{\mathrm{N}}

% For typing out second order base indicies conveniently
\newcommand{\be}[1]{\ta{e}_{#1}}
\newcommand{\bee}[2]{\ta{e}_{#1}\otimes\ta{e}_{#2}}
\newcommand{\beee}[3]{\ta{e}_{#1}\otimes\ta{e}_{#2}\otimes\ta{e}_{#3}}
\newcommand{\beeee}[4]{\ta{e}_{#1}\otimes\ta{e}_{#2}\otimes\ta{e}_{#3}\otimes\ta{e}_{#4}}

% Outer math commands;
\newcommand{\defeq}{\overset{\mathrm{def}}{=}} % For definitions X \defeq Y + 1
%\newcommand{\defeq}{\coloneqq} % alternative
\newcommand{\seteq}{\overset{!}{=}}

\newcommand{\nextts}[1]{\prescript{n}{}{#1}} % Next timestep.
\newcommand{\newts}{\nextts} % New timestep
\newcommand{\oldts}[1]{\prescript{n-1}{}{#1}} % Old timestep.
\newcommand{\zerots}[1]{\prescript{0}{}{#1}} % Timestep 0.

%\usepackage{commath} % Defines \op, \od, \md for derivatives. Usefull. Similarly defined as below;

% Differentiation (like with integrals)
\DeclareMathOperator{\dif}{d \!}
\DeclareMathOperator{\Dif}{D \!}
\DeclareMathOperator{\tr}{tr} % Trace
\DeclareMathOperator{\sign}{sign} % Sign function
\DeclareMathOperator{\spn}{span} % Span of e.g. vectors

\providecommand{\od}[2]{\ensuremath{\frac{\dif #1}{\dif #2}}} % Ordinary derivatives
\providecommand{\pd}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}} % Total derivatives
\providecommand{\md}[3]{\ensuremath{\frac{\partial^2 #1}{\partial #2 \partial #3}}} % Mixed derivatives.

\DeclarePairedDelimiter{\abs}{\lvert}{\rvert} % Absolute value of a scalar \abs x
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert} % Norm of a tensor or vector \norm A or \nornm* A
\DeclarePairedDelimiter{\mcc}{\langle}{\rangle} % McCauley bracket

% Domain
\newcommand*{\intOmega}[1]{\int_\Omega #1 \dif \Omega} % Integration of domain
\newcommand*{\intGammaN}[1]{\int_{\Gamma_\Neumann} #1 \dif \Gamma} % Integration of Neumann boundary

% Time integrals
\newcommand*{\intI}[1]{\int_I #1 \dif t} % Integral over time domain I
\newcommand*{\intIn}[1]{\int_{I_n} #1 \dif t} % Integral over part n of domain I

% Space time integrals
\newcommand{\intIintOmega}[1]{\intI{\intOmega{#1}}} % Integral over time and space

% Definitions of boundary conditions
\newcommand{\pres}{\mathrm{p}} % prescribed value
% Space
\newcommand*{\GammaN}{\Gamma_\Neumann} % Neumann boundary
\newcommand*{\GammaD}{\Gamma_\Dirichlet} % Dirichlet boundary
\newcommand*{\onGammaN}{\mathrm{on}\ \GammaN}
\newcommand*{\onGammaD}{\mathrm{on}\ \GammaD}
\newcommand*{\onGamma}{\mathrm{on}\ \Gamma}
\newcommand*{\inOmega}{\mathrm{in}\ \Omega}
% Space-time
\newcommand*{\onGammaNxI}{\mathrm{on}\ \Gamma_\Neumann\times I}
\newcommand*{\onGammaDxI}{\mathrm{on}\ \Gamma_\Dirichlet\times I}
\newcommand*{\onGammaxI}{\mathrm{on}\ \Gamma\times I}
\newcommand*{\inOmegaxI}{\mathrm{in}\ \Omega\times I}

% Homogenization
\newcommand*{\OmegaBox}{\Omega_\Box}
\newcommand*{\GammaBox}{\Gamma_\Box}
\newcommand*{\intOmegaBox}[1]{\int_{\OmegaBox} #1 \dif \Omega} % Integral over RVE
\newcommand*{\volOmegaBox}{\abs{\Omega_\Box}} % Volume of RVE
\newcommand*{\intGammaNBox}[1]{\int_{\Gamma_{\Neumann,\Box}} #1 \dif \Gamma} % Integral over RVE boundary
\newcommand*{\volGammaBox}{\abs{\Gamma_\Box}} % Volume of RVE boundary
\newcommand*{\volGammaNBox}{\abs{\Gamma_{\Neumann,\Box}}} % Volume of RVE boundary

\DeclarePairedDelimiter{\mccBox}{\langle}{\rangle_\Box}
\DeclarePairedDelimiter{\mccGammaBox}{\langle}{\rangle_{\GammaBox}}

% Boundary conditions
\newcommand*{\onGammaBox}{\mathrm{on}\ \GammaBox}

% Some functionals
\newcommand*{\mBox}{\mathfrak{m}_{\Box}}
\newcommand*{\aBox}{\mathfrak{a}_{\Box}}
\newcommand*{\lBox}{\mathfrak{l}_{\Box}}
\newcommand*{\fBox}{\mathfrak{f}_{\Box}}
\newcommand*{\rBox}{\mathfrak{r}_{\Box}}
\newcommand*{\rBoxzero}{\mathfrak{r}_{\Box 0}}

\newcommand*{\A}{\mathcal{A}} % Operator A

% Convenience commands
\newcommand{\dotbar}[1]{\dot{\bar{#1}}}
\newcommand{\dottilde}[1]{\dot{\tilde{#1}}}
\newcommand{\dotbarbar}[1]{\dot{\bar{\bar{#1}}}}
\newcommand{\barbar}[1]{\bar{\bar{#1}}}
\newcommand{\stat}{\mathrm{stat}} % Stationary part of solution

\newcommand{\hatbar}[1]{\hat{\bar{#1}}}

% Model reduction
\newcommand*{\R}{\mathrm{R}} % Reduced value
\newcommand*{\sumaNR}{\sum_{a = 1}^{N_\R}}
\newcommand*{\sumbNR}{\sum_{b = 1}^{N_\R}}

% Error estimation
\newcommand*{\microsym}{{\micro\sym}} % symmetric part of fluctuation